<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" /> 
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>留言本</title> 
<link rel="stylesheet" href="/css/main.css" />
<script src="/js/jquery.min.js"></script>
<script src="/js/main.js"></script>
<script>
	function isLegal(){
		if($("#nickname").val().length==0||$("#nickname").val().length>200){
			$("#msg").text("昵称长度应大于0小于200。");
			return false;
		}
		if($("#content").val().length<15||$("#nickname").val().length>1000){
			$("#msg").text("内容长度应大于等于15小于1000。");
			return false;
		}
		$("#msg").text("");
		return true;
	}
	$(document).ready(function(){
		$("#sub").click(function(){
			if(isLegal()){
				$.post("/guest/pub",{
					nickname:$("#nickname").val(),
					content:$("#content").val()
				},function(data,status){
					if(status!="success"){
						$("msg").text("发布失败。您的网络可能有问题。");
						return;
					}
					alert(data.resuMessage);
					if(data.resuCode==0){
						window.location.reload(true);
					}
				});
			}
		});
	});
</script>
</head>

<body>
	<div th:utext="${headercode}"></div>
	<div class="container">
		<h1>归零幻想</h1>
		<ul class="nav">
			<li><a href="/">主页</a></li>
			<li><a href="/tags">标签</a></li>
			<li><a href="/rnd">随便看看</a></li>
			<li><a href="/about">关于</a></li>
			<li><a href="/guest">留言</a></li>
			<li><a href="/adm/">后台管理</a></li>
		</ul>
	</div>
	<div class="container" th:each="item : ${msgs}">
		<h2 th:text="${item.getTitle()}">昵称</h2>
		<div class="inf">
			发布时间：<div th:text="${#dates.format(item.getTime(), 'yyyy-MM-dd')}" style="display: inline;"></div>
		</div>
		<hr class="spl">
		<div class="content suojin" th:text="${item.getMd()}">
			想起一个段子，当你在外省丢了身份证，你需要去本省拿户口本补办，你要回去需要坐火车，你要坐火车就需要买票，你要买票就需要身份证……
		</div>
	</div>
	<div class="container">
		<h2>发表留言</h2>
		<div style="text-align:center;">
			<div style="width:90%;text-align:left;margin:0 auto;">
				昵称：<input id="nickname" class="inputb" style="height:30px;">&nbsp;&nbsp;<span id="msg" style="color:#f00;"></span>
			</div>
		</div>
		<div style="text-align:center;">
			<textarea id="content" class="inputb" style="width:90%;margin-top:10px;margin-bottom:10px;height:300px;"></textarea><br>
			<button class="btn" id="sub">提交</button>
		</div>
	</div>
    <div class="container">
		<div class="inf">版权所有：归零幻想 ┊ 备案号：<span th:text="${beian}"></span>┊ Powered by：归零幻想 </div>
    </div>
    <div class="goTop">
    <span>Go</span>
</div>
</body>
</html>